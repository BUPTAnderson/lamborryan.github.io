---
layout: post
title: 小美数据平台总结
date: 2016-04-11 10:30:00
categories: 在学习架构的路上
tags: 数据架构
---

## 1. 前言

小美项目即将结束, 所以有必要抽时间来总结下在小美项目上的得失。

很庆幸在小美项目的7-8个月里, 全程参与了小美大数据平台从无到有的过程, 更加难得的是作为主要的后端开发人员参与了数据平台的架构变迁。中间踩坑的经验是很宝贵的, 所以就有了本文了。

虽然我们团队一直没超过4个人, 但是我们是个很好的团队, 很幸运能遇到他们。

虽然最后数据平台还很不完善, 但是它也经历了3个阶段:

* 第1阶段, 单机的数据平台
* 第2阶段, 混合的数据平台
* 第3阶段, 较完全的大数据平台

## 2. 第1阶段-单机的数据平台

在第一阶段, 数据的需求突然大量增加, 各部门需要大量的数据报表。 需求的增加与项目初期开发人员短缺, 技术积累不够形成了较大矛盾。

考虑到需要快速上手以及快速满足需求, 我们选了Pandas框架来进行数据仓库建模和数据分析, 使用Flask来实现后台数据交互. 同时由于对业务的理解不够深入, 以及产品设计上的不完善, 使得数据仓库的维度模型比较混乱, 维度表与事实表比较模糊。这样造成的结果就是每一个需求都是定制的, 每个开发人员疲于奔命, 数据分析变成了存体力活, 效率底下。

在第1阶段中期, 我们开始慢慢开发我们自己的基于Pandas的XiaoMei ETL-Engineer和XiaoMei Query Engineer来抽象并快速提升开发效率。它们基于jinjia2模板引擎可通过配置文件快速部署开发。在此阶段的任务调度完全就是基于Crontab的顺序调度.

由于此时的业务系统数据库是在Mysql和Mongo上, 在ETL过程中要同时摄取上述两个源. 而Mongo的Nosql特性使得业务系统的同事经常变动里面的字段, 给我们的数据统计造成较大的麻烦。

在第1阶段后期, 通过Pandas的ETL Engineer和Query Engineer, 我们基本上已经能满足日常的数据需求和报表需求。但是我们组在报表等临时需求上投入了过多精力, 大大降低平台搭建速度. 此时的建完模型的数据是存在MySql上的, 但是公司内部会SQL的运营基本没有, 因此我们调研了tableau, 并给需求方进行培训, 让他们通过tableau来满足他们自己的需求, 而我们只需要维护好数据仓库和数据平台即可。

此时的基本框架如下:

![img](../image/architecture/xiaomei-1.png)

该框架已经能基本满足初创团队对于数据统计分析的需求, 它维护成本低,只需部署在单台节点上,操作简单。

## 3. 第2阶段

未完待续

## 4. 第3阶段

未完待续

## 5. 展望

## 6. 总结



本文完




* 原创文章，转载请注明： 转载自[Lamborryan](<http://www.lamborryan.com>)，作者：[Ruan Chengfeng](<http://www.lamborryan.com/about/>)
* 本文链接地址：http://www.lamborryan.com/xiaomei-data-architecture
* 本文基于[署名2.5中国大陆许可协议](<http://creativecommons.org/licenses/by/2.5/cn/>)发布，欢迎转载、演绎或用于商业目的，但是必须保留本文署名和文章链接。 如您有任何疑问或者授权方面的协商，请邮件联系我。
